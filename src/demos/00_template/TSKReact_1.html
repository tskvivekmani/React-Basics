<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>React - Template</title>
    <script src="../../js/react.min.js"></script>
    <script src="../../js/react-dom.min.js"></script>
    <script src="../../js/browser.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react-bootstrap/0.30.7/react-bootstrap.min.js"></script>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap-theme.min.css">
	
	<link rel="stylesheet" type="text/css" href="../../css/main.css" />
</head>
<body>

    <div id="container"></div>
	<div id="demo"></div>

    <script type="text/babel">
        var Alert = ReactBootstrap.Alert;
		var Button = ReactBootstrap.Button;
		var Modal = ReactBootstrap.Modal;
		var ModalHeader = ReactBootstrap.ModalHeader;
		var ModalBody = ReactBootstrap.ModalBody;
		var	ModalFooter = ReactBootstrap.ModalFooter;
		var OverlayTrigger = ReactBootstrap.OverlayTrigger;
		
		function Welcome(props){
			return (
				<div>
					<h1 className="welcome">Hi {props.name}, Welcome to React!</h1>
					<Alert color="error">
						<strong>Well done!</strong> You successfully read this important alert message.
					</Alert>
					<Button
					bsStyle="primary"
					bsSize="large">
						asd
					</Button>
				</div>
				);
		}
		
		class Comment extends React.Component{

			constructor(){
				super();
				this.state = {
					editable:false,
					name: "Vivekmani"
				}
				this.edit = this.edit.bind(this);
				this.remove = this.remove.bind(this);
				this.save = this.save.bind(this);
			}
			
			edit(){
				this.setState({
					editable:true
				});
			}
			
			remove(){
				this.props.removeComment(this.props.index);
			}
			
			save(){
				var text = this.refs.newText.value;
				console.log(text);
				this.props.udpateText(text,this.props.index);
				this.setState({
					editable:false
				});
			}
			
			renderForm(){
				return (
					<div className="commentContainer">
						<textarea ref="newText" className="comment">{this.props.children}</textarea>
						<button onClick={this.save} className="button-success">Save</button>
					</div>
				);
			}
			
			renderList(){
				return (
					<div className="commentContainer">
						<h1 className="comment">{this.props.children}</h1>
						<button onClick={this.edit} className="button-primary">Edit</button>
						<button onClick={this.remove} className="button-danger">Remove</button>
					</div>
				);
			}
			
			render(){
				if(this.state.editable){
					return this.renderForm();
				}
				else{
					return this.renderList()
				}
			}
		}
		
		class Platform extends React.Component{
			constructor(){
				super();
				this.state = {
					showModal:false,
					comments:[
						'Hello',
						'Hi',
						'Howdy'
					],
					taTxt: 'Hello',
					commentJSON:[
						{title: "One" , content: "Number One"},
						{title: "Two" , content: "Number Two"},
						{title: "Three" , content: "Number Three"}
					]
				};
				this.udpateText = this.udpateText.bind(this);
				this.removeComment = this.removeComment.bind(this);
				this.handleChange = this.handleChange.bind(this);
				this.close = this.close.bind(this);
				this.open = this.open.bind(this);
			}
			
			udpateText(text,index){
				var arr = this.state.commentJSON.slice();
				arr[index].content = text;
				this.setState({commentJSON:arr})
			}
			
			removeComment(index){
				var arr = this.state.commentJSON;
				//remove start from the index and the delete count
				arr.splice(index,1);
				this.setState({commentJSON:arr});
			}
			
			addComment(txt){
				var arr = this.state.commentJSON.slice();
				var temp = {title: '', content: txt};
				arr.push(temp);
				this.setState({commentJSON:arr});
			}
			
			getComments(){
				var resp = this.state.commentJSON.map( (obj,i) =>
					<Comment key={i} index={i} udpateText={this.udpateText} removeComment={this.removeComment} title={obj.title}>
						{obj.content}
					</Comment>
				)
				return (
					<div className="board">
						{resp}
					</div>
				)
			}
			
			sendHTTP(){
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
					if (this.status == 200) {
					  document.getElementById("demo").innerHTML =
					  this.responseText;
					}
					else{
						document.getElementById("error").innerHTML =
						this.responseText;
					}
				};
				xhttp.open("GET", "https://facebook.github.io/react-native/movies.json");
				xhttp.send();
			}
			
			componentWillUpdate(){
				
			}
			
			componentDidUpdate(){
				
			}
			
			handleChange(event){
				console.log("OnChange"+event.target.value);
				this.setState({taTxt:event.target.value.toUpperCase()});
			}
			
			handleSubmit(event){
				event.preventDefault();
				console.log(event.target);
				this.addComment(this.state.taTxt);
			}
			
			popupDialog(){
				
			}
			
			close() {
				this.setState({ showModal: false });
			}

			open() {
				this.setState({ showModal: true });
			}
			
			render(){
				return (
					<div>
						{this.getComments()}
						<form onSubmit={this.handleSubmit.bind(this)}>
							<textarea value={this.state.taTxt} onClick={this.popupDialog.bind(this)} onChange={this.handleChange} />
							<Button bsStyle="primary"
							bsSize="large"
							onClick={this.handleSubmit.bind(this)}>Add This!!!</Button>
						</form>
						<button onClick={this.sendHTTP.bind(this)}>Call</button>
						<Button
						  bsStyle="primary"
						  bsSize="large"
						  onClick={this.open}>
						  Launch demo modal
						</Button>
						<Modal backdrop={false}  bsSize="small" show={this.state.showModal} onHide={this.close}>
						  <Modal.Header closeButton>
							<Modal.Title>Modal heading</Modal.Title>
						  </Modal.Header>
						  <Modal.Body>
							<h4>Text in a modal</h4>
							<p>Duis mollis, est non commodo luctus, nisi erat porttitor ligula.</p>
							<hr />

							<h4>Overflowing text to show scroll behavior</h4>
							<p>Cras mattis consectetur purus sit amet fermentum. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Morbi leo risus, porta ac consectetur ac, vestibulum at eros.</p>
							<p>Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor.</p>
							<p>Aenean lacinia bibendum nulla sed consectetur. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Donec sed odio dui. Donec ullamcorper nulla non metus auctor fringilla.</p>
							<p>Cras mattis consectetur purus sit amet fermentum. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Morbi leo risus, porta ac consectetur ac, vestibulum at eros.</p>
							<p>Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor.</p>
							<p>Aenean lacinia bibendum nulla sed consectetur. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Donec sed odio dui. Donec ullamcorper nulla non metus auctor fringilla.</p>
							<p>Cras mattis consectetur purus sit amet fermentum. Cras justo odio, dapibus ac facilisis in, egestas eget quam. Morbi leo risus, porta ac consectetur ac, vestibulum at eros.</p>
							<p>Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor.</p>
							<p>Aenean lacinia bibendum nulla sed consectetur. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Donec sed odio dui. Donec ullamcorper nulla non metus auctor fringilla.</p>
						  </Modal.Body>
						  <Modal.Footer>
							<Button onClick={this.close}>Close</Button>
						  </Modal.Footer>
						</Modal>
					</div>
				);
			}
		}
		
		ReactDOM.render(
			<div>
				<Welcome name="Vivekmani TSK"/>
				<Platform />
			</div>,
            document.getElementById('container')
        );
		
    </script>

</body>
</html>
