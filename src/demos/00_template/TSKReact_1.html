<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>React - Template</title>
    <script src="../../js/react.min.js"></script>
    <script src="../../js/react-dom.min.js"></script>
    <script src="../../js/browser.min.js"></script>
	<script src="../../js/react-with-addons.min.js"></script>
	
	<link rel="stylesheet" type="text/css" href="../../css/main.css" />
</head>
<body>

    <div id="container"></div>

    <script type="text/babel">
        
		function Welcome(props){
			return (
					<h1 className="welcome">Hi {props.name}, Welcome to React!</h1>
				);
		}
		
		class Comment extends React.Component{

			constructor(){
				super();
				this.state = {
					editable:false,
					name: "Vivekmani"
				}
				this.edit = this.edit.bind(this);
				this.remove = this.remove.bind(this);
				this.save = this.save.bind(this);
			}
			
			edit(){
				this.setState({
					editable:true
				});
			}
			
			remove(){
				this.props.removeComment(this.props.index);
			}
			
			save(){
				var text = this.refs.newText.value;
				console.log(text);
				this.props.udpateText(text,this.props.index);
				this.setState({
					editable:false
				});
			}
			
			renderForm(){
				return (
					<div className="commentContainer">
						<textarea ref="newText" className="comment">{this.props.children}</textarea>
						<button onClick={this.save} className="button-success">Save</button>
					</div>
				);
			}
			
			renderList(){
				return (
					<div className="commentContainer">
						<h1 className="comment">{this.props.children}</h1>
						<button onClick={this.edit} className="button-primary">Edit</button>
						<button onClick={this.remove} className="button-danger">Remove</button>
					</div>
				);
			}
			
			render(){
				if(this.state.editable){
					return this.renderForm();
				}
				else{
					return this.renderList()
				}
			}
		}
		
		class Platform extends React.Component{
			constructor(){
				super();
				this.state = {
					comments:[
						'Hello',
						'Hi',
						'Howdy'
					]
				};
				this.udpateText = this.udpateText.bind(this);
				this.removeComment = this.removeComment.bind(this);
			}
			
			udpateText(text,index){
				var arr = this.state.comments;
				arr[index] = text;
				this.setState({comments:arr})
			}
			
			removeComment(index){
				var arr = this.state.comments;
				//remove start from the index and the delete count
				arr.splice(index,1);
				this.setState({comments:arr});
			}
			
			addComment(){
				var arr = this.state.comments;
				arr.push("Default");
				this.setState({comments:arr});
			}
			
			getComments(){
				return (
					<div className="board">
						{
							
							this.state.comments.map( (text,i) =>
								<ul>
									<Comment key={i} index={i} udpateText={this.udpateText} removeComment={this.removeComment}>
										{text}
									</Comment>
								</ul>
							)
						}
					</div>
				)
			}
			
			render(){
				return (
					<div>
						<button className="button-create" onClick={this.addComment.bind(this)}>+</button>
						<a href="tel:9842729112">Call</a>
						{this.getComments()}
					</div>
				);
			}
		}
		
		ReactDOM.render(
			<div>
				<Welcome name="Vivekmani TSK"/>
				<button className="box" >BOX</button>
				<Platform />
			</div>,
            document.getElementById('container')
        );
    </script>

</body>
</html>
